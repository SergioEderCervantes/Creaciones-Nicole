<div class=" flex justify-between w-full text-4xl p-5 bg-gray-100">
    <h1>Bienvenido, {{username | uppercase}}</h1>
</div>

<div class="flex flex-wrap justify-center w-full lg:w-4/5 lg:mx-auto gap-15 min-h-[61vh] my-8 ">
    <!-- Tabla de Productos -->
    <div class="flex flex-col p-4 shadow-2xl  border border-gray-100 h-fit rounded-4xl text-center transition-all duration-300 bg-white "
        [ngClass]="(blocksState['tablaProd'].isMaximized) ? 'w-full': 'w-full md:w-5/12'">
        <!-- Titulo y Opciones -->
        <h3 class="text-2xl font-bold text-gray-700">Productos</h3>

        <div class="flex justify-end my-2 mx-4 gap-1">
            <button (click)="toggleMaximize('tablaProd')"><span class="pi p-1 pi-window-maximize"
                    [ngClass]="(blocksState['tablaProd'].isMaximized)?'pi-window-minimize': ' pi-window-maximize' "></span></button>
        </div>

        @if (blocksState['tablaProd'].loading()){
        <!-- Loader  -->
        <p-progress-spinner class='py-25' strokeWidth="8" fill="transparent" animationDuration=".5s"
            [style]="{ width: '50px', height: '50px' }" />
        } @else {
        @if (products.length === 0) {
        <div class="w-full my-8">
            <p class="text-2xl font-bold">No existen reservaciones registradas por el momento</p>
        </div>
        }@else {
        <!-- Contenido de la tabla -->
        <p-table [columns]="prodCols" [value]="products" class="my-4" showGridlines stripedRows sortField="category"
            [size]='(blocksState["tablaProd"].isMaximized) ? undefined : "small"' [sortOrder]="1" selectionMode="single"
            [(selection)]="selectedProduct" metaKeySelection="true" dataKey="id" (onRowSelect)="onRegisterSelect($event, productType)"
            [scrollable]="true" [scrollHeight]="(blocksState['tablaProd'].isMaximized) ? '400px' : '300px'">
            <ng-template #header let-columns>
                <tr>
                    <th pSortableColumn="category">Categoria <p-sortIcon field="category" /></th>
                    <th pSortableColumn="nombre">Nombre <p-sortIcon field="nombre" /></th>
                    <th pSortableColumn="tags">Tags <p-sortIcon field="tags" /></th>
                    <th>Actions</th>
                </tr>
            </ng-template>
            <ng-template #body let-prod>
                <tr [pSelectableRow]="prod">
                    <td>{{prod.category}}</td>
                    <td>{{prod.name}}</td>
                    <td>{{prod.tags}}</td>
                    <td>
                        <a (click)="handleEdit(productType, prod.id)" class="icon-button mx-1 cursor-pointer">
                            <fa-icon class="hover:text-secondary transition-colors duration-200"
                                [icon]="editIcon"></fa-icon>
                        </a>
                        <a (click)="handleDelete(productType, prod.id)" class="icon-button mx-1 cursor-pointer">
                            <fa-icon class="hover:text-secondary transition-colors duration-200"
                                [icon]="deleteIcon"></fa-icon>
                        </a>
                    </td>
                </tr>
            </ng-template>
        </p-table>
        }
        }
        <button (click)="handleNew(productType)"
            class="group flex items-center justify-between w-10 h-10 px-[11px] mt-4 cursor-pointer border border-gray-400 rounded-full bg-gray-200 hover:w-35 hover:bg-gray-300 transition-all duration-300 ">
            <fa-icon class="group-hover:text-secondary" [icon]="addIcon"></fa-icon>
            <span
                class="mt-[-3px] opacity-0 mr-4 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap">
                Agregar
            </span>
        </button>
    </div>

    <!-- Tabla de Pedidos -->
    <div class="flex flex-col p-4 shadow-2xl  border border-gray-100 h-fit rounded-4xl text-center transition-all duration-300 bg-white "
        [ngClass]="(blocksState['tablaOrd'].isMaximized) ? 'w-full': 'w-full md:w-5/12'">
        <!-- Titulo y Opciones -->
        <h3 class="text-2xl font-bold text-gray-700">Pedidos</h3>

        <div class="flex justify-end my-2 mx-4 gap-1">
            <button (click)="toggleMaximize('tablaOrd')"><span class="pi p-1 pi-window-maximize"
                    [ngClass]="(blocksState['tablaOrd'].isMaximized)?'pi-window-minimize': ' pi-window-maximize' "></span></button>
        </div>

        @if (blocksState['tablaOrd'].loading()){
        <!-- Loader  -->
        <p-progress-spinner class='py-25' strokeWidth="8" fill="transparent" animationDuration=".5s"
            [style]="{ width: '50px', height: '50px' }" />
        }
        @else {
        @if (orders.length === 0) {
        <!-- Mensaje de que no hay registros -->
        <div class="w-full my-8">
            <p class="text-2xl font-bold">No existen objetos perdidos registrados por el momento</p>
        </div>
        } @else {
        <!-- Contenido de la tabla -->
        <p-toast />
        <p-table [columns]="ordCols" [value]="orders" class="my-4" showGridlines stripedRows sortField="deliveryDate"
            [size]='(blocksState["tablaOrd"].isMaximized) ? undefined : "small"' [sortOrder]="1" selectionMode="single"
            [(selection)]="selectedOrder" metaKeySelection="true" dataKey="id" (onRowSelect)="onRegisterSelect($event, orderType)"
            [scrollable]="true" [scrollHeight]="(blocksState['tablaOrd'].isMaximized) ? '400px' : '300px'">
            <ng-template #header let-columns>
                <tr>
                    <th pSortableColumn="state">Estado del pedido <p-sortIcon field="state" /></th>
                    <th pSortableColumn="name">Nombre del perdido <p-sortIcon field="name" /></th>
                    <th pSortableColumn="amount">Amount <p-sortIcon field="amount" /></th>
                    <th pSortableColumn="deliveryDate">Fecha de entrega <p-sortIcon field="deliveryDate" /></th>
                    <th>Actions</th>
                </tr>
            </ng-template>
            <ng-template #body let-order>
                <tr [pSelectableRow]="order">
                    <td>{{order.state}}</td>
                    <td>{{order.name}}</td>
                    <td>{{order.amount}}</td>
                    <td>{{order.deliveryDate}}</td>
                    <td>
                        <a (click)="handleEdit(orderType, order.id)" class="icon-button mx-1 cursor-pointer">
                            <fa-icon class="hover:text-secondary transition-colors duration-200"
                                [icon]="editIcon"></fa-icon>
                        </a>
                        <a (click)="handleDelete(orderType, order.id)" class="icon-button mx-1 cursor-pointer">
                            <fa-icon class="hover:text-secondary transition-colors duration-200"
                                [icon]="deleteIcon"></fa-icon>
                        </a>
                    </td>
                </tr>
            </ng-template>
        </p-table>
        }
        }

        <button (click)="handleNew(orderType)"
            class="group flex items-center justify-between w-10 h-10 px-[11px] mt-4 cursor-pointer border border-gray-400 rounded-full bg-gray-200 hover:w-35 hover:bg-gray-300 transition-all duration-300 ">
            <fa-icon class="group-hover:text-secondary" [icon]="addIcon"></fa-icon>
            <span
                class="mt-[-3px] opacity-0 mr-4 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap">
                Agregar
            </span>
        </button>
    </div>

</div>